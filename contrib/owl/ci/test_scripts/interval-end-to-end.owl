--cleanup environment
drop owltable testIntervalOwlTable within owldatabase testIntervalE2EDB;
drop owltable testIntervalOwlTable1 within owldatabase testIntervalE2EDB;
drop owldatabase testIntervalE2EDB;

--Initialize environment
create owldatabase testIntervalE2EDB identified by storage directory "hdfs://namenode:8080/data/testIntervalowldatabase";  

select owldatabase objects where owldatabase in (testIntervalE2EDB);

create owltable type basic testIntervalOwlTable
within owldatabase testIntervalE2EDB define property key retention:INTEGER 
partitioned by INTERVAL ("2009-10-28 00:00:00 PDT", 15 Minutes)
with partition key part1
schema "test1:int";

create owltable type basic testIntervalOwlTable1
within owldatabase testIntervalE2EDB define property key name:STRING 
partitioned by INTERVAL ("2009-10-28 00:10:00 PDT", 15 Minutes)
with partition key part1
schema "test1:int";

select owltable objects where owldatabase in (testIntervalE2EDB);

describe owltable testIntervalOwlTable within owldatabase testIntervalE2EDB;
describe owltable testIntervalOwlTable1 within owldatabase testIntervalE2EDB;

--publish test data
publish dataelement to owltable testIntervalOwlTable within owldatabase testIntervalE2EDB 
 partition (part1 = "2009-10-28 00:00:00 PDT") property(retention = "1") 
 schema "c1:int" delocation "testloc1";

publish dataelement to owltable testIntervalOwlTable within owldatabase testIntervalE2EDB
 partition (part1 = "2009-10-28 15:00:00 PDT") 
 schema "c1:int" delocation "testloc2";

publish dataelement to owltable testIntervalOwlTable within owldatabase testIntervalE2EDB
 partition (part1 = "2009-10-28 18:00:00 PDT") 
 schema "c1:int" delocation "testloc3";

publish dataelement to owltable testIntervalOwlTable1 within owldatabase testIntervalE2EDB
 partition (part1 = "2009-10-28 00:15:00 PDT") 
 schema "c1:int" delocation "testloc4";


publish dataelement to owltable testIntervalOwlTable1 within owldatabase testIntervalE2EDB
 partition (part1 = "2009-10-28 00:25:00 PDT") 
 schema "c1:int" delocation "testloc5";

select dataelement objects from owltable testIntervalOwlTable within owldatabase testIntervalE2EDB with partition ( part1 = "2009-10-28 00:00:00 PDT" ); 
select dataelement objects from owltable testIntervalOwlTable within owldatabase testIntervalE2EDB with partition ( part1 = "2009-10-28 15:00:00 PDT" );
select dataelement objects from owltable testIntervalOwlTable within owldatabase testIntervalE2EDB with partition ( part1 = "2009-10-28 18:00:00 PDT" );
select dataelement objects from owltable testIntervalOwlTable1 within owldatabase testIntervalE2EDB with partition ( part1 = "2009-10-28 00:15:00 PDT" );
select dataelement objects from owltable testIntervalOwlTable1 within owldatabase testIntervalE2EDB with partition ( part1 = "2009-10-28 00:25:00 PDT" );

--select partitionproperty objects

select partitionproperty objects from owltable testIntervalOwlTable within owldatabase testIntervalE2EDB with partition (part1 = "2009-10-28 00:00:00 PDT");

--alter
alter owltable testIntervalOwlTable within owldatabase testIntervalE2EDB with partition (part1 = "2009-10-28 00:00:00 PDT") modify property (retention ="1000");

select dataelement objects from owltable testIntervalOwlTable within owldatabase testIntervalE2EDB with partition ( part1 = "2009-10-28 00:00:00 PDT" );

select dataelement objects from owltable testIntervalOwlTable within owldatabase testIntervalE2EDB with partition ( part1 = "2009-10-28 00:00:00 PDT" );

--cleanup environment
drop owltable testIntervalOwlTable within owldatabase testIntervalE2EDB;
drop owltable testIntervalOwlTable1 within owldatabase testIntervalE2EDB;
drop owldatabase testIntervalE2EDB;
