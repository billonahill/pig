--cleanup environment
drop owltable testkeys within owldatabase testkeyowldatabase;
drop owltable testkeys2 within owldatabase testkeyowldatabase;
drop owldatabase testkeyowldatabase;

--Initialize environment
create owldatabase testkeyowldatabase identified by
 storage directory "http://namenode:8080/data/testkeyowldatabase";


create owltable type basic testkeys
within owldatabase testkeyowldatabase
define property key prkot : INTEGER

partitioned by LIST with partition key part1 : INTEGER
define property key prk1 : INTEGER 

partitioned by LIST with partition key part2 : INTEGER
define property key prk2 : INTEGER

partitioned by LIST with partition key part3 : INTEGER
define property key prk3 : INTEGER
schema "test1:int";

create owltable type basic testkeys2 within owldatabase testkeyowldatabase
partitioned by LIST with partition key part1 : STRING
schema "test1:int";


publish dataelement to owltable testkeys within owldatabase testkeyowldatabase
 partition (part1 = 1, part2 = 2, part3 = 3)
 property (prk1 = 11, prk2 = 22, prk3 = 33)
 schema "c1:int" delocation "testloc1";

publish dataelement to owltable testkeys within owldatabase testkeyowldatabase
 partition (part1 = 101, part2 = 2, part3 = 3)
 property (prk1 = 11, prk2 = 22, prk3 = 33)
 schema "c1:int" delocation "testloc2";

publish dataelement to owltable testkeys2 within owldatabase testkeyowldatabase partition (part1 = "abc1") schema "c1:int" delocation "key2loc1";
publish dataelement to owltable testkeys2 within owldatabase testkeyowldatabase partition (part1 = "2abc2") schema "c1:int" delocation "key2loc2";
publish dataelement to owltable testkeys2 within owldatabase testkeyowldatabase partition (part1 = "3abc") schema "c1:int" delocation "key2loc3";
publish dataelement to owltable testkeys2 within owldatabase testkeyowldatabase partition (part1 = "def") schema "c1:int" delocation "key2loc4";

select partitionproperty objects from owltable testkeys within owldatabase testkeyowldatabase with partition ( part1 = 1 );
select partitionproperty objects from owltable testkeys within owldatabase testkeyowldatabase with partition ( part1 = 1, part2=2  );
select partitionproperty objects from owltable testkeys within owldatabase testkeyowldatabase with partition ( part1 = 1, part2=2, part3=3 );

select dataelement objects from owltable testkeys within owldatabase testkeyowldatabase with partition ( part1 = 1 ) property ( prk2=22 );

select dataelement objects from owltable testkeys2 within owldatabase testkeyowldatabase with partition ( part1 like "%abc%" );
select dataelement objects from owltable testkeys2 within owldatabase testkeyowldatabase with partition ( part1 like "%def%" );



--cleanup
drop owltable testkeys within owldatabase testkeyowldatabase;
drop owltable testkeys2 within owldatabase testkeyowldatabase;
drop owldatabase testkeyowldatabase;
